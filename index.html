<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Woordenschatspel met Pacman XL</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f172a, #1e293b);
            color: #f1f5f9;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        header {
            text-align: center;
            padding: 30px;
            background: rgba(30, 41, 59, 0.7);
            border-radius: 20px;
            border: 2px solid #3b82f6;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }
        
        h1 {
            color: #fbbf24;
            font-size: 3rem;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .subtitle {
            color: #94a3b8;
            font-size: 1.1rem;
        }

        .game-layout {
            display: grid;
            grid-template-columns: 450px 1fr;
            gap: 20px;
        }

        /* Quiz Styling */
        .card {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid #334155;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            color: #fbbf24;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            justify-content: space-between;
        }

        .quiz-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-weight: bold;
            color: #38bdf8;
        }

        .question-box {
            background: #0f172a;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            min-height: 80px;
            border-left: 5px solid #fbbf24;
        }

        .options {
            display: grid;
            gap: 10px;
        }

        .option-btn {
            background: #1e293b;
            border: 2px solid #334155;
            color: white;
            padding: 12px 15px;
            border-radius: 10px;
            cursor: pointer;
            text-align: left;
            transition: 0.2s;
        }

        .option-btn:hover:not(:disabled) {
            background: #334155;
            border-color: #3b82f6;
        }

        .option-btn.correct { background: #065f46; border-color: #10b981; }
        .option-btn.wrong { background: #7f1d1d; border-color: #ef4444; }

        /* Input section */
        .input-group {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }

        input {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #334155;
            background: #0f172a;
            color: white;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: 0.2s;
        }

        .btn-primary { background: #3b82f6; color: white; }
        .btn-gold { background: #fbbf24; color: #0f172a; }

        /* Pacman Area */
        .pacman-canvas-container {
            background: #000;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 4px solid #334155;
        }

        #gameCanvas {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.2);
        }

        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .level-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #fbbf24;
            color: #000;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .hidden { display: none !important; }

        @media (max-width: 1000px) {
            .game-layout { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Woordenschatspel XL</h1>
        <p class="subtitle">Breid je woordenschat uit en ontgrendel uitdagende Pacman levels!</p>
    </header>

    <div class="game-layout">
        <!-- LINKER KOLOM: QUIZ -->
        <div class="card">
            <div class="section-title">
                <span>Quiz</span>
                <span id="level-indicator">Nodig: 5</span>
            </div>
            
            <div class="quiz-info">
                <span>Score: <span id="quiz-score">0</span></span>
                <span>Vraag: <span id="quiz-count">0</span></span>
            </div>

            <div id="quiz-play-area">
                <div class="question-box" id="question-text">Voeg eerst woorden toe om te kunnen spelen...</div>
                <div class="options" id="options-container"></div>
            </div>

            <hr style="margin: 25px 0; border: 0; border-top: 1px solid #334155;">

            <div class="word-management">
                <p style="margin-bottom: 10px; font-weight: bold;">Woorden Beheren</p>
                <div class="input-group">
                    <input type="text" id="word-input" placeholder="Woord">
                    <input type="text" id="def-input" placeholder="Betekenis">
                </div>
                <button class="btn btn-primary" style="width: 100%; margin-top: 10px;" onclick="addWord()">Woord Toevoegen</button>
                <div id="word-list-mini" style="margin-top: 10px; font-size: 0.8rem; color: #94a3b8;"></div>
            </div>
        </div>

        <!-- RECHTER KOLOM: PACMAN -->
        <div class="pacman-canvas-container" id="game-view">
            <div class="level-badge">Level <span id="current-level">1</span></div>
            
            <canvas id="gameCanvas" width="800" height="600"></canvas>

            <div id="game-overlay" class="overlay">
                <h2 id="overlay-title" style="color: #fbbf24; font-size: 2.5rem; margin-bottom: 20px;">GEBLOKKEERD</h2>
                <p id="overlay-desc" style="margin-bottom: 30px; text-align: center;">Beantwoord 5 vragen correct om dit level te spelen.</p>
                <button class="btn btn-gold" id="start-btn" onclick="tryStartGame()" disabled>Start Level</button>
            </div>

            <div id="game-stats" style="width: 100%; padding: 10px 20px; display: flex; justify-content: space-between; background: #1e293b;">
                <span>Punten: <span id="game-score">0</span></span>
                <span>Bolletjes: <span id="dots-left">0</span></span>
            </div>
        </div>
    </div>
</div>

<script>
    // --- STATE MANAGEMENT ---
    let words = [
        {w: "Innovatie", d: "Vernieuwing van technologie of methoden"},
        {w: "Ambivalentie", d: "Tegenstrijdige gevoelens hebben"},
        {w: "Consensus", d: "Overeenstemming in een groep"},
        {w: "Paradigma", d: "Een stelsel van opvattingen/denkkader"},
        {w: "Authentiek", d: "Echt, betrouwbaar en origineel"},
        {w: "Eloquente", d: "Welbespraakt en overtuigend"}
    ];

    let gameState = {
        quizScore: 0,
        questionsAnswered: 0,
        neededToPlay: 5,
        level: 1,
        unlocked: false,
        playing: false
    };

    // --- QUIZ LOGICA ---
    function addWord() {
        const w = document.getElementById('word-input').value;
        const d = document.getElementById('def-input').value;
        if(w && d) {
            words.push({w, d});
            document.getElementById('word-input').value = '';
            document.getElementById('def-input').value = '';
            updateWordMiniList();
            if(!gameState.playing) nextQuestion();
        }
    }

    function updateWordMiniList() {
        document.getElementById('word-list-mini').innerText = "In lijst: " + words.map(x => x.w).join(', ');
    }

    function generateQuestion() {
        if(words.length < 4) return null;
        const correct = words[Math.floor(Math.random() * words.length)];
        let options = [correct.d];
        
        while(options.length < 4) {
            const wrong = words[Math.floor(Math.random() * words.length)].d;
            if(!options.includes(wrong)) options.push(wrong);
        }
        
        return {
            q: `Wat is de betekenis van '${correct.w}'?`,
            options: options.sort(() => Math.random() - 0.5),
            answer: correct.d
        };
    }

    function nextQuestion() {
        const data = generateQuestion();
        if(!data) return;

        document.getElementById('question-text').innerText = data.q;
        const container = document.getElementById('options-container');
        container.innerHTML = '';

        data.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(btn, opt === data.answer);
            container.appendChild(btn);
        });
    }

    function checkAnswer(btn, isCorrect) {
        if(isCorrect) {
            btn.classList.add('correct');
            gameState.quizScore++;
        } else {
            btn.classList.add('wrong');
        }

        document.querySelectorAll('.option-btn').forEach(b => b.disabled = true);
        gameState.questionsAnswered++;
        
        document.getElementById('quiz-score').innerText = gameState.quizScore;
        document.getElementById('quiz-count').innerText = gameState.questionsAnswered;

        if(gameState.quizScore >= gameState.neededToPlay) {
            unlockGame();
        }

        setTimeout(nextQuestion, 1000);
    }

    function unlockGame() {
        gameState.unlocked = true;
        document.getElementById('overlay-title').innerText = "LEVEL VRIJGESPEELD";
        document.getElementById('overlay-desc').innerText = "Je bent er klaar voor! Gebruik de pijltjestoetsen.";
        document.getElementById('start-btn').disabled = false;
        document.getElementById('start-btn').classList.add('btn-gold');
    }

    // --- PACMAN LOGICA (EXTRA GROOT & LEVELS) ---
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const TILE_SIZE = 30; // Grotere tiles
    const COLS = 26;
    const ROWS = 20;

    let pacman = { x: 1, y: 1, dir: 0, nextDir: 0, anim: 0 };
    let ghosts = [];
    let map = [];
    let dots = 0;
    let gameLoop;

    // Maze generator (simpel grid met muren)
    function createMap() {
        map = [];
        dots = 0;
        for(let y=0; y<ROWS; y++) {
            map[y] = [];
            for(let x=0; x<COLS; x++) {
                // Muren rondom
                if(x===0 || y===0 || x===COLS-1 || y===ROWS-1) {
                    map[y][x] = 1;
                } else if (x % 2 === 0 && y % 2 === 0) {
                    map[y][x] = 1; // Raster van blokken
                } else if (Math.random() < 0.15) {
                    map[y][x] = 1; // Willekeurige extra muren
                } else {
                    map[y][x] = 0; // Pad
                    dots++;
                }
            }
        }
        // Startplek Pacman leeg
        map[1][1] = 0;
        document.getElementById('dots-left').innerText = dots;
    }

    function spawnGhosts() {
        ghosts = [];
        const count = 2 + gameState.level; // Meer ghosts per level
        for(let i=0; i<count; i++) {
            ghosts.push({
                x: COLS-2, 
                y: ROWS-2, 
                color: `hsl(${i * 60}, 100%, 50%)`,
                speed: 0.05 + (gameState.level * 0.02) // Sneller per level
            });
        }
    }

    function tryStartGame() {
        document.getElementById('game-overlay').classList.add('hidden');
        gameState.playing = true;
        createMap();
        spawnGhosts();
        pacman = { x: 1, y: 1, dir: 0, nextDir: 0, anim: 0 };
        if(gameLoop) clearInterval(gameLoop);
        gameLoop = setInterval(update, 1000/60);
    }

    function update() {
        // Pacman beweging logic
        moveEntity(pacman, pacman.nextDir, 0.12);
        
        // Eet bolletje
        let gx = Math.round(pacman.x);
        let gy = Math.round(pacman.y);
        if(map[gy][gx] === 0) {
            map[gy][gx] = 2; // Gegeten
            dots--;
            gameState.quizScore += 10;
            document.getElementById('game-score').innerText = gameState.quizScore;
            document.getElementById('dots-left').innerText = dots;
            
            if(dots <= 0) winLevel();
        }

        // Ghost AI
        ghosts.forEach(g => {
            // Simpele volg-beweging
            let dx = pacman.x - g.x;
            let dy = pacman.y - g.y;
            if(Math.abs(dx) > Math.abs(dy)) {
                moveEntity(g, dx > 0 ? 1 : 3, g.speed);
            } else {
                moveEntity(g, dy > 0 ? 2 : 0, g.speed);
            }

            // Botsing met Pacman
            if(Math.hypot(pacman.x - g.x, pacman.y - g.y) < 0.6) {
                gameOver();
            }
        });

        draw();
    }

    function moveEntity(ent, dir, speed) {
        let nx = ent.x;
        let ny = ent.y;
        if(dir === 0) ny -= speed;
        if(dir === 1) nx += speed;
        if(dir === 2) ny += speed;
        if(dir === 3) nx -= speed;

        // Wall collision check
        if(map[Math.floor(ny+0.1)][Math.floor(nx+0.1)] !== 1 && 
           map[Math.ceil(ny-0.1)][Math.ceil(nx-0.1)] !== 1) {
            ent.x = nx;
            ent.y = ny;
            ent.dir = dir;
        }
    }

    function draw() {
        ctx.fillStyle = "#000";
        ctx.fillRect(0,0, canvas.width, canvas.height);

        // Map
        for(let y=0; y<ROWS; y++) {
            for(let x=0; x<COLS; x++) {
                if(map[y][x] === 1) {
                    ctx.fillStyle = "#1e40af";
                    ctx.fillRect(x*TILE_SIZE+2, y*TILE_SIZE+2, TILE_SIZE-4, TILE_SIZE-4);
                } else if(map[y][x] === 0) {
                    ctx.fillStyle = "#fff";
                    ctx.beginPath();
                    ctx.arc(x*TILE_SIZE+TILE_SIZE/2, y*TILE_SIZE+TILE_SIZE/2, 2, 0, Math.PI*2);
                    ctx.fill();
                }
            }
        }

        // Pacman
        ctx.fillStyle = "#fbbf24";
        ctx.beginPath();
        let px = pacman.x * TILE_SIZE + TILE_SIZE/2;
        let py = pacman.y * TILE_SIZE + TILE_SIZE/2;
        ctx.arc(px, py, TILE_SIZE/2-2, 0.2, Math.PI*2-0.2);
        ctx.lineTo(px, py);
        ctx.fill();

        // Ghosts
        ghosts.forEach(g => {
            ctx.fillStyle = g.color;
            ctx.beginPath();
            ctx.arc(g.x * TILE_SIZE + TILE_SIZE/2, g.y * TILE_SIZE + TILE_SIZE/2, TILE_SIZE/2-2, 0, Math.PI*2);
            ctx.fill();
        });
    }

    function winLevel() {
        clearInterval(gameLoop);
        gameState.level++;
        gameState.quizScore = 0;
        gameState.unlocked = false;
        gameState.playing = false;
        
        document.getElementById('current-level').innerText = gameState.level;
        document.getElementById('overlay-title').innerText = "LEVEL VOLTOOID!";
        document.getElementById('overlay-desc').innerText = "Beantwoord weer 5 vragen voor Level " + gameState.level;
        document.getElementById('start-btn').disabled = true;
        document.getElementById('game-overlay').classList.remove('hidden');
    }

    function gameOver() {
        clearInterval(gameLoop);
        gameState.quizScore = 0;
        gameState.unlocked = false;
        gameState.playing = false;
        
        document.getElementById('overlay-title').innerText = "GAME OVER";
        document.getElementById('overlay-desc').innerText = "De spoken hebben je gepakt! Oefen je woorden om opnieuw te proberen.";
        document.getElementById('start-btn').disabled = true;
        document.getElementById('game-overlay').classList.remove('hidden');
        document.getElementById('quiz-score').innerText = 0;
    }

    // Controls
    window.addEventListener('keydown', e => {
        if(e.key === "ArrowUp") pacman.nextDir = 0;
        if(e.key === "ArrowRight") pacman.nextDir = 1;
        if(e.key === "ArrowDown") pacman.nextDir = 2;
        if(e.key === "ArrowLeft") pacman.nextDir = 3;
    });

    // Start
    updateWordMiniList();
    nextQuestion();
    createMap();
    draw();

</script>
</body>
</html>
