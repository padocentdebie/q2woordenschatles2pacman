<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pacman Woordenschat PRO - FINAL FIX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
        body { background: #020617; color: #fff; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 380px 1fr; gap: 20px; }
        header { grid-column: span 2; text-align: center; padding: 15px; background: #1e293b; border: 3px solid #3b82f6; border-radius: 15px; margin-bottom: 10px; }
        h1 { color: #fbbf24; text-transform: uppercase; font-size: 1.8rem; }
        
        .section { background: #1e293b; padding: 20px; border-radius: 15px; border: 2px solid #334155; }
        .question-box { background: #0f172a; padding: 20px; border-radius: 10px; margin: 15px 0; min-height: 120px; border-left: 5px solid #fbbf24; display: flex; align-items: center; justify-content: center; text-align: center; font-weight: bold; font-size: 1.2em; line-height: 1.4; }
        
        .option-btn { width: 100%; text-align: left; padding: 14px; margin-bottom: 10px; background: #334155; color: white; border: 1px solid #475569; cursor: pointer; border-radius: 8px; font-size: 1rem; transition: all 0.2s; }
        .option-btn:hover:not(:disabled) { background: #475569; transform: translateX(5px); }
        .option-btn:disabled { cursor: default; }
        .correct { background: #15803d !important; border-color: #22c55e !important; font-weight: bold; }
        .incorrect { background: #b91c1c !important; border-color: #ef4444 !important; opacity: 0.8; }
        
        canvas { background: #000; border: 4px solid #334155; border-radius: 10px; display: block; margin: 0 auto; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .start-game-btn { 
            width: 100%; padding: 20px; font-size: 1.4rem; font-weight: bold; border-radius: 10px; border: none; 
            background: #334155; color: #64748b; cursor: not-allowed; margin-top: 20px; transition: all 0.3s;
        }
        .unlocked { background: linear-gradient(135deg, #f59e0b, #d97706) !important; color: white !important; cursor: pointer !important; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 0px #f59e0b; } 50% { transform: scale(1.02); box-shadow: 0 0 25px #f59e0b; } 100% { transform: scale(1); box-shadow: 0 0 0px #f59e0b; } }
        
        .stats-bar { display: flex; justify-content: space-between; margin-bottom: 10px; padding: 12px; background: #0f172a; border-radius: 8px; color: #fbbf24; font-weight: bold; font-size: 1.1rem; }
        .feedback-text { height: 40px; text-align: center; font-weight: bold; font-size: 1.1rem; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Pacman Woordenschat PRO</h1>
        <p>Scoor 5 punten in de quiz om Pacman vrij te spelen!</p>
    </header>

    <!-- LINKS: DE QUIZ -->
    <div class="section">
        <h3 class="text-xl font-bold mb-4 text-blue-400 flex justify-between items-center">
            <span>Woordentest</span>
            <span class="text-sm bg-blue-900 px-2 py-1 rounded">Punten: <span id="correct-count">0</span>/5</span>
        </h3>
        
        <div id="quiz-container">
            <div id="question-box" class="question-box">Klik op de startknop om de quiz te laden!</div>
            <div id="options-container">
                <button class="option-btn" style="background: #10b981; text-align: center; font-weight: bold;" onclick="initQuiz()">START DE QUIZ</button>
            </div>
            <div id="feedback" class="feedback-text"></div>
            <button id="next-btn" class="option-btn" style="display:none; background:#fbbf24; color:black; text-align:center; font-weight:bold; border:none;" onclick="renderQuestion()">VOLGENDE VRAAG ‚ûî</button>
        </div>
    </div>

    <!-- RECHTS: HET SPEL -->
    <div class="game-section section">
        <div class="stats-bar">
            <span>Score: <span id="game-score">0</span></span>
            <span>‚ù§Ô∏è Levens: <span id="game-lives">3</span></span>
        </div>
        <canvas id="gameCanvas" width="560" height="300"></canvas>
        <button id="start-game-btn" class="start-game-btn" disabled onclick="startGame()">SPEL VERGRENDELD</button>
    </div>
</div>

<script>
// ================= DATA =================
const vocabData = [
    { w: "zeer goede", c: "uitmuntende", o: ["aangename", "flinke"] },
    { w: "cr√®che", c: "kinderdagverblijf", o: ["gietemmer", "mensen met wie je verbonden bent"] },
    { w: "voerbakken", c: "troggen", o: ["donateurs", "filialen"] },
    { w: "ophef", c: "beroering", o: ["argumentatie", "walging"] },
    { w: "Een ... plan", c: "indrukwekkend", o: ["idioot", "gevoelig"] },
    { w: "fauteuil", c: "armstoel", o: ["leidinggevende functie", "traditioneel"] },
    { w: "correspondentie", c: "briefwisseling", o: ["armstoel", "goedkeuring"] },
    { w: "barok", c: "stijl met overdadige vormen", o: ["godsdienstuiting", "meer dan nodig"] },
    { w: "aangewakkerd", c: "feller doen branden", o: ["niet fris", "met betrekking tot"] },
    { w: ".... weer", c: "onstuimig", o: ["sober", "uitbundig"] },
    { w: "eerbied", c: "respect", o: ["plotselinge gedachte", "godsdienst"] },
    { w: "traject", c: "een afgelegde weg", o: ["paviljoen", "festival"] },
    { w: "flora", c: "plantenwereld", o: ["bodemkunde", "dierenwereld"] }
];

let activeQuestions = [];
let currentIdx = 0;
let points = 0;

// ================= QUIZ LOGICA =================
function initQuiz() {
    points = 0;
    currentIdx = 0;
    document.getElementById('correct-count').innerText = "0";
    // Shuffle en selecteer
    activeQuestions = [...vocabData].sort(() => Math.random() - 0.5);
    renderQuestion();
}

function renderQuestion() {
    if (currentIdx >= activeQuestions.length) {
        document.getElementById('question-box').innerText = "Quiz voltooid! Start opnieuw voor meer punten.";
        document.getElementById('options-container').innerHTML = `<button class="option-btn" style="background: #10b981; text-align: center; font-weight: bold;" onclick="initQuiz()">OPNIEUW STARTEN</button>`;
        document.getElementById('next-btn').style.display = 'none';
        return;
    }

    const q = activeQuestions[currentIdx];
    const options = [q.c, ...q.o].sort(() => Math.random() - 0.5);
    
    document.getElementById('question-box').innerText = `Wat is de betekenis van: "${q.w}"?`;
    document.getElementById('feedback').innerText = "";
    document.getElementById('next-btn').style.display = "none";
    
    const container = document.getElementById('options-container');
    container.innerHTML = "";
    
    options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.innerText = opt;
        btn.onclick = () => handleAnswer(opt, q.c, btn);
        container.appendChild(btn);
    });
}

function handleAnswer(selected, correct, btn) {
    const allBtns = document.querySelectorAll('.option-btn');
    allBtns.forEach(b => b.disabled = true);

    if (selected === correct) {
        btn.classList.add('correct');
        document.getElementById('feedback').innerText = "GOED ZO! üéâ";
        document.getElementById('feedback').style.color = "#22c55e";
        points++;
        document.getElementById('correct-count').innerText = points;
        if (points >= 5) unlockGame();
    } else {
        btn.classList.add('incorrect');
        document.getElementById('feedback').innerText = "Helaas, het was: " + correct;
        document.getElementById('feedback').style.color = "#ef4444";
    }

    currentIdx++;
    document.getElementById('next-btn').style.display = "block";
}

function unlockGame() {
    const btn = document.getElementById('start-game-btn');
    btn.disabled = false;
    btn.classList.add('unlocked');
    btn.innerText = "START PACMAN (NU BESCHIKBAAR!)";
}

// ================= PACMAN LOGICA =================
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const tileSize = 20;

let gameRunning = false;
let gameScore = 0;
let gameLives = 3;
let powerTimer = 0;
let pacman = { x: 20, y: 20, dir: 0, nextDir: 0, speed: 2 };
let ghosts = [];

const mazeMap = [
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    [1,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,1,1,2,2,3,1],
    [1,2,1,1,2,1,1,1,1,2,1,1,2,1,1,1,1,2,1,1,1,2,1,1,2,1,2,1],
    [1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
    [1,2,1,1,2,1,1,2,1,1,1,1,1,2,1,1,2,1,1,1,1,1,2,1,1,1,2,1],
    [1,2,2,2,2,1,1,2,2,2,1,1,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,1],
    [1,1,1,1,2,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1],
    [1,0,0,0
