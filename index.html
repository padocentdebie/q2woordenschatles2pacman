<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pacman Woordenschat PRO - Final Alignment</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
        body { background: #020617; color: #fff; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 380px 1fr; gap: 20px; }
        header { grid-column: span 2; text-align: center; padding: 15px; background: #1e293b; border: 3px solid #3b82f6; border-radius: 15px; margin-bottom: 10px; }
        h1 { color: #fbbf24; text-transform: uppercase; font-size: 1.8rem; }
        
        .section { background: #1e293b; padding: 20px; border-radius: 15px; border: 2px solid #334155; }
        .question-box { background: #0f172a; padding: 20px; border-radius: 10px; margin: 15px 0; min-height: 120px; border-left: 5px solid #fbbf24; display: flex; align-items: center; justify-content: center; text-align: center; font-weight: bold; font-size: 1.2em; line-height: 1.4; }
        
        .option-btn { width: 100%; text-align: left; padding: 14px; margin-bottom: 10px; background: #334155; color: white; border: 1px solid #475569; cursor: pointer; border-radius: 8px; font-size: 1rem; transition: all 0.2s; }
        .option-btn:hover:not(:disabled) { background: #475569; transform: translateX(5px); }
        .option-btn:disabled { cursor: default; }
        .correct { background: #15803d !important; border-color: #22c55e !important; font-weight: bold; }
        .incorrect { background: #b91c1c !important; border-color: #ef4444 !important; opacity: 0.8; }
        
        canvas { background: #000; border: 4px solid #334155; border-radius: 10px; display: block; margin: 0 auto; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .start-game-btn { 
            width: 100%; padding: 20px; font-size: 1.4rem; font-weight: bold; border-radius: 10px; border: none; 
            background: #334155; color: #64748b; cursor: not-allowed; margin-top: 20px; transition: all 0.3s;
        }
        .unlocked { background: linear-gradient(135deg, #f59e0b, #d97706) !important; color: white !important; cursor: pointer !important; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 0px #f59e0b; } 50% { transform: scale(1.02); box-shadow: 0 0 25px #f59e0b; } 100% { transform: scale(1); box-shadow: 0 0 0px #f59e0b; } }
        
        .stats-bar { display: flex; justify-content: space-between; margin-bottom: 10px; padding: 12px; background: #0f172a; border-radius: 8px; color: #fbbf24; font-weight: bold; font-size: 1.1rem; }
        .feedback-text { height: 40px; text-align: center; font-weight: bold; font-size: 1.1rem; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Pacman Woordenschat PRO</h1>
        <p>Scoor 5 punten in de quiz om Pacman vrij te spelen!</p>
    </header>

    <div class="section">
        <h3 class="text-xl font-bold mb-4 text-blue-400 flex justify-between items-center">
            <span>Woordentest</span>
            <span class="text-sm bg-blue-900 px-2 py-1 rounded">Punten: <span id="correct-count">0</span>/5</span>
        </h3>
        
        <div id="quiz-container">
            <div id="question-box" class="question-box">Klik op de startknop om de quiz te laden!</div>
            <div id="options-container">
                <button class="option-btn" style="background: #10b981; text-align: center; font-weight: bold;" onclick="initQuiz()">START DE QUIZ</button>
            </div>
            <div id="feedback" class="feedback-text"></div>
            <button id="next-btn" class="option-btn" style="display:none; background:#fbbf24; color:black; text-align:center; font-weight:bold; border:none;" onclick="renderQuestion()">VOLGENDE VRAAG ‚ûî</button>
        </div>
    </div>

    <div class="game-section section">
        <div class="stats-bar">
            <span>Score: <span id="game-score">0</span></span>
            <span>‚ù§Ô∏è Levens: <span id="game-lives">3</span></span>
        </div>
        <canvas id="gameCanvas" width="560" height="300"></canvas>
        <button id="start-game-btn" class="start-game-btn" disabled onclick="startGame()">SPEL VERGRENDELD</button>
    </div>
</div>

<script>
// ================= DATA =================
const vocabData = [
    { w: "zeer goede", c: "uitmuntende", o: ["aangename", "flinke"] },
    { w: "cr√®che", c: "kinderdagverblijf", o: ["gietemmer", "mensen met wie je verbonden bent"] },
    { w: "voerbakken", c: "troggen", o: ["donateurs", "filialen"] },
    { w: "ophef", c: "beroering", o: ["argumentatie", "walging"] },
    { w: "Een ... plan", c: "indrukwekkend", o: ["idioot", "gevoelig"] },
    { w: "fauteuil", c: "armstoel", o: ["leidinggevende functie", "traditioneel"] },
    { w: "correspondentie", c: "briefwisseling", o: ["armstoel", "goedkeuring"] },
    { w: "barok", c: "stijl met overdadige vormen", o: ["godsdienstuiting", "meer dan nodig"] },
    { w: "aangewakkerd", c: "feller doen branden", o: ["niet fris", "met betrekking tot"] },
    { w: ".... weer", c: "onstuimig", o: ["sober", "uitbundig"] },
    { w: "eerbied", c: "respect", o: ["plotselinge gedachte", "godsdienst"] },
    { w: "traject", c: "een afgelegde weg", o: ["paviljoen", "festival"] },
    { w: "flora", c: "plantenwereld", o: ["bodemkunde", "dierenwereld"] }
];

let activeQuestions = [];
let currentIdx = 0;
let points = 0;
let gameUnlocked = false;

// ================= QUIZ LOGICA =================
function initQuiz() {
    points = 0;
    currentIdx = 0;
    document.getElementById('correct-count').innerText = "0";
    activeQuestions = [...vocabData].sort(() => Math.random() - 0.5);
    renderQuestion();
}

function renderQuestion() {
    if (currentIdx >= activeQuestions.length) {
        document.getElementById('question-box').innerText = "Quiz voltooid! Start opnieuw voor meer punten.";
        document.getElementById('options-container').innerHTML = `<button class="option-btn" style="background: #10b981; text-align: center; font-weight: bold;" onclick="initQuiz()">OPNIEUW STARTEN</button>`;
        document.getElementById('next-btn').style.display = 'none';
        return;
    }

    const q = activeQuestions[currentIdx];
    const options = [q.c, ...q.o].sort(() => Math.random() - 0.5);
    
    document.getElementById('question-box').innerText = `Wat is de betekenis van: "${q.w}"?`;
    document.getElementById('feedback').innerText = "";
    document.getElementById('next-btn').style.display = "none";
    
    const container = document.getElementById('options-container');
    container.innerHTML = "";
    
    options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.innerText = opt;
        btn.onclick = () => handleAnswer(opt, q.c, btn);
        container.appendChild(btn);
    });
}

function handleAnswer(selected, correct, btn) {
    const allBtns = document.querySelectorAll('.option-btn');
    allBtns.forEach(b => b.disabled = true);

    if (selected === correct) {
        btn.classList.add('correct');
        document.getElementById('feedback').innerText = "GOED ZO! üéâ";
        document.getElementById('feedback').style.color = "#22c55e";
        points++;
        document.getElementById('correct-count').innerText = points;
        if (points >= 5) unlockGame();
    } else {
        btn.classList.add('incorrect');
        document.getElementById('feedback').innerText = "Helaas, het was: " + correct;
        document.getElementById('feedback').style.color = "#ef4444";
    }

    currentIdx++;
    document.getElementById('next-btn').style.display = "block";
}

function unlockGame() {
    if(gameUnlocked) return;
    gameUnlocked = true;
    const btn = document.getElementById('start-game-btn');
    btn.disabled = false;
    btn.classList.add('unlocked');
    btn.innerText = "START PACMAN (NU BESCHIKBAAR!)";
}

// ================= PACMAN LOGICA =================
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const tileSize = 20;

let gameRunning = false;
let gameScore = 0;
let gameLives = 3;
let powerTimer = 0;
let pacman = { x: 20, y: 20, dir: 0, nextDir: 0, speed: 2 };
let ghosts = [];

const mazeMap = [
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    [1,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,1,1,2,2,3,1],
    [1,2,1,1,2,1,1,1,1,2,1,1,2,1,1,1,1,2,1,1,1,2,1,1,2,1,2,1],
    [1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
    [1,2,1,1,2,1,1,2,1,1,1,1,1,2,1,1,2,1,1,1,1,1,2,1,1,1,2,1],
    [1,2,2,2,2,1,1,2,2,2,1,1,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,1],
    [1,1,1,1,2,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1],
    [1,0,0,0,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,0,0,0,1],
    [1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1],
    [1,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,1],
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
];
let currentMaze = mazeMap.map(row => [...row]);

function drawMaze() {
    ctx.fillStyle = "black";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    
    for(let r=0; r < currentMaze.length; r++) {
        for(let c=0; c < currentMaze[r].length; c++) {
            let x = c * tileSize;
            let y = r * tileSize;
            if(currentMaze[r][c] === 1) {
                ctx.fillStyle = "#1e40af";
                ctx.fillRect(x + 2, y + 2, tileSize - 4, tileSize - 4);
            } else if(currentMaze[r][c] === 2) {
                ctx.fillStyle = "#fbbf24";
                ctx.beginPath(); ctx.arc(x + 10, y + 10, 2, 0, Math.PI*2); ctx.fill();
            } else if(currentMaze[r][c] === 3) {
                ctx.fillStyle = "#fff";
                ctx.beginPath(); ctx.arc(x + 10, y + 10, 6, 0, Math.PI*2); ctx.fill();
            }
        }
    }
}

function initEntities() {
    // Pacman exact gecentreerd op (1,1) -> x:20, y:20
    pacman = { x: 20, y: 20, dir: 0, nextDir: 0, speed: 2 };
    ghosts = [
        { x: 240, y: 140, color: '#ef4444', dir: 0, speed: 1.5 },
        { x: 280, y: 140, color: '#ec4899', dir: 2, speed: 1.2 }
    ];
}

function canMove(x, y, dir) {
    // We checken de hoekpunten van de collision box
    let nx = x, ny = y;
    const margin = 7; // Iets kleiner dan 10 om soepel te draaien
    
    if(dir === 0) nx += margin; 
    if(dir === 1) ny += margin;
    if(dir === 2) nx -= margin; 
    if(dir === 3) ny -= margin;
    
    const col = Math.floor(nx / tileSize);
    const row = Math.floor(ny / tileSize);
    return currentMaze[row] && currentMaze[row][col] !== 1;
}

function gameLoop() {
    if(!gameRunning) return;

    // Movement: Alleen draaien als we bijna exact in het midden van een tile zijn
    const centerDistX = Math.abs((pacman.x + 10) % tileSize - 10);
    const centerDistY = Math.abs((pacman.y + 10) % tileSize - 10);

    if (pacman.dir !== pacman.nextDir) {
        if (centerDistX < 3 && centerDistY < 3) {
            const gridX = Math.round(pacman.x / tileSize) * tileSize;
            const gridY = Math.round(pacman.y / tileSize) * tileSize;
            
            if (canMove(gridX + 10, gridY + 10, pacman.nextDir)) {
                pacman.x = gridX;
                pacman.y = gridY;
                pacman.dir = pacman.nextDir;
            }
        }
    }

    let dx=0, dy=0;
    if(pacman.dir===0) dx=pacman.speed; 
    if(pacman.dir===1) dy=pacman.speed;
    if(pacman.dir===2) dx=-pacman.speed; 
    if(pacman.dir===3) dy=-pacman.speed;
    
    // Bewegen als het pad vrij is
    if(canMove(pacman.x + 10 + dx, pacman.y + 10 + dy, pacman.dir)) {
        pacman.x += dx; 
        pacman.y += dy;
    }

    // Eten: Check het middelpunt van pacman
    const pr = Math.floor((pacman.y + 10) / tileSize);
    const pc = Math.floor((pacman.x + 10) / tileSize);
    
    if(currentMaze[pr] && currentMaze[pr][pc] > 1) { 
        if(currentMaze[pr][pc] === 2) gameScore += 10;
        if(currentMaze[pr][pc] === 3) { gameScore += 50; powerTimer = 400; }
        currentMaze[pr][pc] = 0; 
    }

    if(powerTimer > 0) powerTimer--;

    // Ghost Logic
    ghosts.forEach(g => {
        const gx = g.x + 10, gy = g.y + 10;
        if(Math.random() < 0.05 || !canMove(gx, gy, g.dir)) {
            g.dir = Math.floor(Math.random()*4);
        }
        let gdx=0, gdy=0;
        if(g.dir===0) gdx=g.speed; if(g.dir===1) gdy=g.speed;
        if(g.dir===2) gdx=-g.speed; if(g.dir===3) gdy=-g.speed;
        if(canMove(gx+gdx, gy+gdy, g.dir)) { g.x += gdx; g.y += gdy; }

        if(Math.hypot(pacman.x - g.x, pacman.y - g.y) < 15) {
            if(powerTimer > 0) {
                g.x = 240; g.y = 140; gameScore += 200;
            } else {
                gameLives--;
                if(gameLives <= 0) {
                    gameRunning = false;
                    alert("GAME OVER! Je eindscore: " + gameScore);
                } else {
                    initEntities();
                }
            }
        }
    });

    document.getElementById('game-score').innerText = gameScore;
    document.getElementById('game-lives').innerText = gameLives;
    
    drawMaze();
    
    // Render Pacman (exact gecentreerd tekenen)
    ctx.fillStyle = "yellow";
    ctx.beginPath();
    const mouthOpen = Math.sin(Date.now() / 100) * 0.2 + 0.2;
    ctx.arc(pacman.x+10, pacman.y+10, 8, (mouthOpen + pacman.dir*0.5)*Math.PI, (2 - mouthOpen + pacman.dir*0.5)*Math.PI);
    ctx.lineTo(pacman.x+10, pacman.y+10); 
    ctx.fill();

    // Render Ghosts
    ghosts.forEach(g => {
        ctx.fillStyle = powerTimer > 0 ? "#2563eb" : g.color;
        ctx.beginPath(); ctx.arc(g.x+10, g.y+10, 8, Math.PI, 0);
        ctx.lineTo(g.x+18, g.y+18); ctx.lineTo(g.x+2, g.y+18); ctx.fill();
    });

    requestAnimationFrame(gameLoop);
}

function startGame() {
    if(!gameUnlocked || gameRunning) return;
    currentMaze = mazeMap.map(row => [...row]);
    gameScore = 0; gameLives = 3; gameRunning = true;
    initEntities();
    gameLoop();
}

window.addEventListener("keydown", e => {
    if(e.key === 'ArrowRight') pacman.nextDir = 0;
    if(e.key === 'ArrowDown') pacman.nextDir = 1;
    if(e.key === 'ArrowLeft') pacman.nextDir = 2;
    if(e.key === 'ArrowUp') pacman.nextDir = 3;
    if(e.key.includes("Arrow")) e.preventDefault();
});

drawMaze();
</script>
</body>
</html>
