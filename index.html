<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pacman Woordenschat PRO - FIXED</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
        body { background: #020617; color: #fff; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 400px 1fr; gap: 20px; }
        header { grid-column: span 2; text-align: center; padding: 20px; background: #1e293b; border: 3px solid #3b82f6; border-radius: 15px; }
        h1 { color: #fbbf24; text-transform: uppercase; }
        
        /* Quiz Sectie */
        .section { background: #1e293b; padding: 20px; border-radius: 15px; border: 2px solid #334155; }
        .word-list { max-height: 100px; overflow-y: auto; background: #0f172a; padding: 10px; margin: 10px 0; border-radius: 8px; font-size: 0.8em; }
        .question-box { background: #0f172a; padding: 15px; border-radius: 10px; margin: 15px 0; min-height: 100px; border-left: 5px solid #fbbf24; display: flex; align-items: center; justify-content: center; text-align: center; font-weight: bold; }
        
        .option-btn { width: 100%; text-align: left; padding: 12px; margin-bottom: 8px; background: #334155; color: white; border: 1px solid #475569; cursor: pointer; border-radius: 8px; transition: 0.2s; }
        .option-btn:hover { background: #475569; }
        .correct { background: #15803d !important; border-color: #22c55e !important; }
        .incorrect { background: #b91c1c !important; border-color: #ef4444 !important; }
        
        /* Game Sectie */
        canvas { background: #000; border: 4px solid #334155; border-radius: 10px; display: block; margin: 0 auto; }
        .start-game-btn { 
            width: 100%; padding: 18px; font-size: 1.3rem; font-weight: bold; border-radius: 10px; border: none; 
            background: #475569; color: #94a3b8; cursor: not-allowed; margin-top: 15px;
        }
        .unlocked { background: linear-gradient(135deg, #f59e0b, #d97706) !important; color: white !important; cursor: pointer !important; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0px #f59e0b; } 50% { box-shadow: 0 0 20px #f59e0b; } 100% { box-shadow: 0 0 0px #f59e0b; } }
        
        .stats-bar { display: flex; justify-content: space-between; margin-bottom: 10px; padding: 10px; background: #0f172a; border-radius: 8px; color: #fbbf24; font-weight: bold; }
        .feedback { height: 30px; text-align: center; font-weight: bold; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Pacman Woordenschat PRO</h1>
        <p>Start de quiz, scoor 5 punten en versla de spoken!</p>
    </header>

    <div class="section">
        <h3>1. De Woordentest</h3>
        <div class="word-list" id="word-list">Laden...</div>
        <button id="gen-btn" class="option-btn" style="background: #10b981; text-align: center; font-weight: bold; border:none;" onclick="generateQuestions()">NIEUWE QUIZ STARTEN</button>
        
        <div id="quiz-area">
            <div class="question-box" id="question-box">Klik op de groene knop om te beginnen!</div>
            <div id="options-container"></div>
            <div id="feedback" class="feedback"></div>
            <button id="next-btn" class="option-btn" style="display:none; background:#fbbf24; color:black; text-align:center; font-weight:bold; border:none;" onclick="loadQuestion()">VOLGENDE VRAAG ➔</button>
        </div>
        <div style="text-align: center; margin-top: 10px;">
            Punten voor Unlock: <span id="correct-count" style="color:#fbbf24; font-size: 1.5em; font-weight:bold;">0</span> / 5
        </div>
    </div>

    <div class="game-section section">
        <div class="stats-bar">
            <span>Score: <span id="game-score">0</span></span>
            <span>Level: <span id="game-level">1</span></span>
        </div>
        <canvas id="gameCanvas" width="600" height="400"></canvas>
        <button id="start-game-btn" class="start-game-btn" disabled onclick="startGame()">START PACMAN</button>
    </div>
</div>

<script>
// ================= DATA =================
const rawWords = [
    { w: "zeer goede", c: "uitmuntende", o: ["aangename", "flinke"] },
    { w: "crèche", c: "kinderdagverblijf", o: ["gietemmer", "mensen met wie je verbonden bent"] },
    { w: "voerbakken", c: "troggen", o: ["donateurs", "filialen"] },
    { w: "ophef", c: "beroering", o: ["argumentatie", "walging"] },
    { w: "Een ... plan", c: "indrukwekkend", o: ["idioot", "gevoelig"] },
    { w: "fauteuil", c: "armstoel", o: ["leidinggevende functie", "traditioneel"] },
    { w: "rechten ... aan", c: "ontlenen", o: ["controleren", "bereiken"] },
    { w: "correspondentie", c: "briefwisseling", o: ["armstoel", "goedkeuring"] },
    { w: "barok", c: "stijl met kenmerk overdadige vormen", o: ["godsdienstuiting", "meer dan nodig is"] },
    { w: "aangewakkerd", c: "feller doen branden", o: ["niet fris", "met betrekking tot"] },
    { w: "belangstellend", c: "erbij betrokken zijn", o: ["met veel betekenis", "beter voordoen dan de werkelijkheid"] },
    { w: ".... weer", c: "onstuimig", o: ["sober", "uitbundig"] },
    { w: "eerbied", c: "respect", o: ["plotselinge gedachte", "godsdienst"] },
    { w: "het schip is ...", c: "buitengaats", o: ["enigszins", "tenminste"] },
    { w: "tja, dan vraag je...", c: "erom", o: ["ertoe", "erdoor"] },
    { w: "door ontsporing is het ... afgesloten", c: "traject", o: ["paviljoen", "festival"] },
    { w: "mode", c: "manier van kleden, denken, taalgebruik in een bepaalde tijd", o: ["humeur", "tekst in een krant"] },
    { w: "kanon", c: "zwaar vuurwapen met lange loop", o: ["machinegeweer", "handvuurwapen"] },
    { w: "moord / zware vorm van...", c: "doodslag", o: ["aanranding", "slijtage"] },
    { w: "hulp in de ..", c: "huishouding", o: ["administratie", "huisraad"] },
    { w: "continentaal", c: "behoort tot het vaste land", o: ["attractief", "laatste rustplaats"] },
    { w: "de ... in Europa", c: "economie", o: ["dyslexie", "criminaliteit"] },
    { w: "verandering van situatie", c: "overgang", o: ["omruil", "erosie"] },
    { w: "kleine ruimte in huis", c: "vliering", o: ["bedding", "achterkant"] },
    { w: "flora", c: "plantenwereld", o: ["wetenschap over de bodem van de aarde", "dierenwereld"] },
    { w: "kleding laten stomen", c: "door stoom schoonmaken", o: ["in vroegere staat herstellen", "kleding gladmaken met een strijkbout"] },
    { w: "bloederig slijm", c: "met veel bloed bedekt", o: ["waar veel van is", "gruwelijk"] },
    { w: "social media ... elkaar", c: "becommentariëren", o: ["bevrijden", "bewonderen"] },
    { w: "de ... is 4-4", c: "tussenstand", o: ["overtreding", "overwinning"] },
    { w: "opbouw van een tekst", c: "manier waarop de tekst is samengesteld", o: ["inleiding", "opschudding"] }
];

let questions = [];
let currentQIndex = 0;
let correctScore = 0;
let gameUnlocked = false;

// ================= QUIZ LOGICA =================
function updateWordList() {
    const list = document.getElementById('word-list');
    list.innerHTML = rawWords.slice(0, 10).map(item => `<div class="word-item">${item.w} = ${item.c}</div>`).join('');
}

function generateQuestions() {
    // Reset quiz maar behoud unlock status als die al bereikt was
    currentQIndex = 0;
    questions = rawWords.sort(() => Math.random() - 0.5).map(item => {
        let opts = [item.c, ...item.o].sort(() => Math.random() - 0.5);
        return { q: item.w, correct: item.c, options: opts };
    });
    loadQuestion();
}

function loadQuestion() {
    if (questions.length === 0) return;
    
    const q = questions[currentQIndex];
    document.getElementById('feedback').innerText = '';
    document.getElementById('next-btn').style.display = 'none';
    document.getElementById('question-box').innerText = `Betekenis van: "${q.q}"?`;
    
    const container = document.getElementById('options-container');
    container.innerHTML = '';
    
    q.options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.innerText = opt;
        btn.onclick = () => checkAnswer(opt, btn);
        container.appendChild(btn);
    });
}

function checkAnswer(selected, btn) {
    const q = questions[currentQIndex];
    document.querySelectorAll('.option-btn').forEach(b => b.style.pointerEvents = 'none');
    
    if(selected === q.correct) {
        btn.classList.add('correct');
        document.getElementById('feedback').innerText = "Goed gedaan!";
        document.getElementById('feedback').style.color = "#22c55e";
        correctScore++;
        document.getElementById('correct-count').innerText = correctScore;
        if(correctScore >= 5) unlockGame();
    } else {
        btn.classList.add('incorrect');
        document.getElementById('feedback').innerText = "Helaas, fout.";
        document.getElementById('feedback').style.color = "#ef4444";
    }
    
    currentQIndex++;
    document.getElementById('next-btn').style.display = 'block';
}

function unlockGame() {
    gameUnlocked = true;
    const btn = document.getElementById('start-game-btn');
    btn.disabled = false;
    btn.classList.add('unlocked');
    btn.innerText = "START PACMAN (UNLOCKED)";
}

// ================= PACMAN LOGICA =================
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const tileSize = 20;
let gameActive = false;
let score = 0;
let level = 1;
let animationId;
let pacman = { x: 20, y: 20, dir: 'right' };
let ghosts = [];
let powerActive = false;
let powerTimer = 0;

const mapTemplate = [
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    [1,3,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,3,1],
    [1,0,1,1,0,1,1,1,0,1,1,0,1,1,1,1,1,1,0,1,1,0,1,1,1,0,1,1,0,1],
    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
    [1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,0,1,1,0,1],
    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
    [1,1,1,1,1,0,1,1,0,1,1,1,1,2,2,2,2,1,1,1,1,0,1,1,0,1,1,1,1,1],
    [1,0,0,0,0,0,1,1,0,1,2,2,2,2,2,2,2,2,2,1,0,0,1,1,0,0,0,0,0,1],
    [1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1],
    [1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,1],
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
];
let currentMap = [];

function initGame() {
    currentMap = mapTemplate.map(row => [...row]);
    pacman = { x: 20, y: 20, dir: 'right' };
    ghosts = [
        { x: 260, y: 140, color: 'red', dir: 'up', startX: 260, startY: 140 },
        { x: 300, y: 140, color: 'pink', dir: 'down', startX: 300, startY: 140 }
    ];
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for(let r=0; r<currentMap.length; r++) {
        for(let c=0; c<currentMap[r].length; c++) {
            let x = c*tileSize, y = r*tileSize;
            if(currentMap[r][c] === 1) { ctx.fillStyle = "#1e40af"; ctx.fillRect(x,y,tileSize,tileSize); }
            if(currentMap[r][c] === 0) { ctx.fillStyle = "#fbbf24"; ctx.beginPath(); ctx.arc(x+10,y+10,2,0,7); ctx.fill(); }
            if(currentMap[r][c] === 3) { ctx.fillStyle = "#fff"; ctx.beginPath(); ctx.arc(x+10,y+10,6,0,7); ctx.fill(); }
        }
    }
    // Pacman
    ctx.fillStyle = "yellow";
    ctx.beginPath(); ctx.arc(pacman.x+10, pacman.y+10, 8, 0.2*Math.PI, 1.8*Math.PI); ctx.lineTo(pacman.x+10, pacman.y+10); ctx.fill();
    // Ghosts
    ghosts.forEach(g => {
        ctx.fillStyle = powerActive ? "#1e40af" : g.color;
        ctx.beginPath(); ctx.arc(g.x+10, g.y+10, 8, Math.PI, 0); ctx.lineTo(g.x+18, g.y+18); ctx.lineTo(g.x+2, g.y+18); ctx.fill();
    });
}

function update() {
    if(!gameActive) return;
    let nx = pacman.x, ny = pacman.y;
    if(pacman.dir === 'left') nx -= 2; if(pacman.dir === 'right') nx += 2;
    if(pacman.dir === 'up') ny -= 2; if(pacman.dir === 'down') ny += 2;

    let r = Math.floor((ny+2)/tileSize), c = Math.floor((nx+2)/tileSize);
    if(currentMap[r] && currentMap[r][c] !== 1) { 
        pacman.x = nx; pacman.y = ny; 
        if(currentMap[r][c] === 0) { currentMap[r][c] = 2; score += 10; }
        if(currentMap[r][c] === 3) { currentMap[r][c] = 2; powerActive = true; powerTimer = 300; }
    }

    if(powerActive) { powerTimer--; if(powerTimer <= 0) powerActive = false; }

    ghosts.forEach(g => {
        let gx = g.x, gy = g.y;
        if(g.dir === 'up') gy -= 1; else if(g.dir === 'down') gy += 1;
        else if(g.dir === 'left') gx -= 1; else gx += 1;

        if(currentMap[Math.floor((gy+10)/tileSize)][Math.floor((gx+10)/tileSize)] === 1) {
            g.dir = ['up','down','left','right'][Math.floor(Math.random()*4)];
        } else { g.x = gx; g.y = gy; }

        if(Math.abs(g.x - pacman.x) < 15 && Math.abs(g.y - pacman.y) < 15) {
            if(powerActive) { g.x = g.startX; g.y = g.startY; score += 100; }
            else { gameActive = false; alert("Game Over! Score: " + score); }
        }
    });

    document.getElementById('game-score').innerText = score;
    draw();
    animationId = requestAnimationFrame(update);
}

function startGame() {
    if(!gameUnlocked) return;
    score = 0; gameActive = true; initGame(); update();
}

window.addEventListener("keydown", e => {
    if(e.key.includes("Arrow")) { e.preventDefault(); pacman.dir = e.key.replace("Arrow","").toLowerCase(); }
});

updateWordList();
draw();
</script>
</body>
</html>
